<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v2.1.6/css/unicons.css">
    <link rel="stylesheet" href="/style/css.css">
    <script src="/js/repeat_pwd_script.js"></script>
    <title>updateProfile</title>
    <script>
        
        


    </script>
</head>
<body>
    <!--navbar-->
    <nav class="navbar navbar1 fixed-top navbar-expand-md"  style="background-color: rgb(39, 40, 43);" >
        <div class="container" >
            <a href="#" class="navbar-brand nb-0 h1">
                <img src="/images/Logo11.png" alt="Logo" height="60em" width="200em" class="d-inline-black align-top mt-0">
            </a>
            <button type="button" 
                data-bs-toggle="collapse" 
                data-bs-target="#navbarNav" 
                class="navbar-toggler collapsed d-flex d-lg-none flex-column justify-content-around" 
                aria-controls="navbarNav" 
                aria-expanded="false" 
                aria-label="Toggle navigation" >
                <span class="toggler-icon top-bar"></span>
                <span class="toggler-icon middle-bar"></span>
                <span class="toggler-icon bottom-bar"></span>
            </button>
            <div class="collapse navbar-collapse " id="navbarNav"> 
                <ul class="navbar-nav ">
                    <li class="nav-item active">
                        <a href="/" class="nav-link text-white">
                            Home
                        </a>
                    </li>
                </ul>
            </div>
            <form action="#" class="d-flex">
                <input type="text" class="form-control me-2">
                <button type="submit" class="btn bg-primary text-white">
                    Search
                </button>    
            </form>
            <span class="ms-lg-3 ms-sm-1 px-0 py-0"><a href="#notifications" data-bs-toggle="collapse" class="menu-item d-flex text-decoration-none text-dark" id="notifications">
                <i class="me-3 uil text-white uil-bell"><small class="notifications-count">9+</small></i>
                </a></span>
            <!--Notifications popup-->
            <div class="notifications-popup fixed-top collapse col-lg-3 py-2 px-3 bg-white me-0 " id="notifications">
                <div>
                    <div class="rounded-circle  profile-picture ms-lg-3 ms-sm-1 px-0 py-0">
                        <img src="/images/cloud.jpg" alt="">
                    </div>
                    <div class="notification-body">
                        <b>Mohammed</b> Accepted your friend request
                        <small class="text-muted">2 DAYS AGO</small>
                    </div>
                    <div class="rounded-circle profile-picture ms-lg-3 ms-sm-1 px-0 py-0">
                        <img src="/images/cloud.jpg" alt="">
                    </div>
                    <div class="notification-body">
                        <b>Mohammed</b> Accepted your friend request
                        <small class="text-muted">2 DAYS AGO</small>
                    </div>
                    <div class="rounded-circle profile-picture ms-lg-3 ms-sm-1 px-0 py-0">
                        <img src="/images/cloud.jpg" alt="">
                    </div>
                    <div class="notification-body">
                        <b>Mohammed</b> Accepted your friend request
                        <small class="text-muted">2 DAYS AGO</small>
                    </div>
                    <div class="rounded-circle profile-picture ms-lg-3 ms-sm-1 px-0 py-0">
                        <img src="/images/cloud.jpg" alt="">
                    </div>
                    <div class="notification-body">
                        <b>Mohammed</b> Accepted your friend request
                        <small class="text-muted">2 DAYS AGO</small>
                    </div>
                    <div class="rounded-circle profile-picture ms-lg-3 ms-sm-1 px-0 py-0">
                        <img src="/images/cloud.jpg" alt="">
                    </div>
                    <div class="notification-body">
                        <b>Mohammed</b> Accepted your friend request
                        <small class="text-muted">2 DAYS AGO</small>
                    </div>
                </div>
            </div>   
            <span class="ms-lg-3 ms-sm-1 px-0 py-0">
                <a href="#" class="menu-item d-flex text-decoration-none text-dark" id="messages-notifications">
                <i class="me-3 uil text-white uil-envelope-alt"><small class="notifications-count">6</small></i>
                </a>
            </span>
            <!--profile-->
            <span class="rounded-circle  profile-picture ms-sm-1 px-0 py-0"><a  data-bs-toggle="collapse" href="#profile" role="button" aria-expanded="false" aria-controls="profile"><img class="mx-0 my-0 img-picture" src="/images/user-avatar.png" alt=""></a></span>
            <div class="profile fixed-top collapse col-lg-3 py-2 px-3 bg-white me-0 " id="profile">
                <a href="#" class="text-decoration-none text-dark">
                    <div class="ms-lg-3 ms-sm-1 px-0 py-0">
                        <img src="/images/user_avatar.png"  class="img-picture" alt="profile-photo" >
                        <div class="handle">
                            <h4 class="name"></h4>
                            <p class="text-muted username">
                                
                            </p>
                        </div>
                    </div>
                </a>
                <a href="#" class="menu-item d-flex mt-5 text-decoration-none text-dark">
                        <span><i class="me-3 uil uil-setting"></i></span>
                        Settings
                    </a>
                <label for="log_out" class="mt-5"><span class="rounded-pill bg-dark ms-lg-3 ms-sm-1 px-3 py-2 mx-5 my-5"><a href="/logout" class="text-light text-decoration-none">Logout</a></span></label>
            </div>
        </div>
    </nav>
    <!--body-->
    
    <section class="vh-75 mb-5 " style="margin-top:10rem;">
		<div class="container h-100">
		  <div class="row d-flex justify-content-center align-items-center h-100">
			<div class="col-lg-12 col-xl-11">
			  <div class="card text-black" style="border-radius: 25px;">
				<div class="card-body p-md-5">
				  <div class="row justify-content-center">
					<div class="col-md-10 col-lg-6 col-xl-5 order-2 order-lg-1">
	  
					    <p class="text-center h1 fw-bold mb-5 mx-1 mx-md-4 mt-4">Edit profile</p>
                        
        
                        <form class="mx-1 mx-md-4" method="dialog" action="/updateProfile" onsubmit="return doUpdateProfile(this)">

                            <div class="d-flex flex-row align-items-center mb-4">
                                <i class="fas fa-user fa-lg me-3 fa-fw"></i>
                                <div class="form-outline flex-fill mb-0">
                                <input type="text" name="name"  id="name" value="" class="form-control" name="name" minlength="8" maxlength="32" name="name" pattern="[A-Za-z +]{1,32}" />
                                <label class="form-label" for="name">Your Name</label>
                                </div>
                            </div>
                            <!-- input Username-->
                            <div class="d-flex flex-row align-items-center mb-4">
                                <i class="fas fa-user fa-lg me-3 fa-fw"></i>
                                <div class="form-outline flex-fill mb-0">
                                    <input type="text" name="username" id="username" class="form-control" />
                                    <label class="form-label" for="username">Username</label>
                                </div>
                            </div>

                            <div class="d-flex flex-row align-items-center mb-4">
                                <i class="fas fa-laptop fa-lg me-3 ja-fw"></i> 
                                <div class="form-outline flex-fill mb-0">
                                <input type="text" name="country" class="form-control" />
                                <label class="form-label" for="country">Your country</label>
                                </div>
                            </div>
        
                            <div class="d-flex flex-row align-items-center mb-4">
                            <i class="fas fa-briefcase fa-lg me-3 fa-fw"></i>
                            <div class="form-outline flex-fill mb-0">
                                <input type="text" name="city" class="form-control" />
                                <label class="form-label" for="city">Your city</label>
                            </div>
                            </div>

                            <div class="d-flex flex-row align-items-center mb-4">
                                <i class="mtrl-select"></i>
                                <div class="form-outline flex-fill mb-0">
                                    <textarea rows="4" class="aboutMe ms-5 " cols="32" name="aboutMe" id="aboutMe"></textarea>
                                    <br><label class="form-label ms-5" for="aboutMe" >About Me</label>
                                </div>
                            </div>

                           
        
                            <div class="d-flex flex-row align-items-center mb-4">
                            <i class="fas fa-envelope fa-lg me-3 fa-fw"></i>
                            <div class="form-outline flex-fill mb-0">
                                <input type="email" name="email" class="form-control" />
                                <label class="form-label" for="email">Your Email</label>
                            </div>
                            </div>
        
                            <div class="d-flex flex-row align-items-center mb-4">
                            <i class="fas fa-lock fa-lg me-3 fa-fw"></i>
                            <div class="form-outline flex-fill mb-0">
                                <input type="password" name="password" class="form-control" />
                                <label class="form-label" for="password">Password</label>
                            </div>
                            </div>
        
                            <div class="d-flex flex-row align-items-center mb-4">
                            <i class="fas fa-key fa-lg me-3 fa-fw"></i>
                            <div class="form-outline flex-fill mb-0">
                                <input type="password" name="pwd_repeat" class="form-control" />
                                <label class="form-label" for="pwd_repeat">Repeat your password</label>
                                <p id="error" class="text-danger "></p>

                            </div>
                            </div>

                            <div class="d-flex justify-content-center mx-4 mb-3 mb-lg-4">
                                <button type="submit" name="submit" class="btn btn-dark btn-lg" >Save</button>
                            </div>
	  
                        </form>
	  
					</div>

					<div class="col-md-10 col-lg-6 col-xl-7 d-flex align-items-center order-1 order-lg-2">
                        <div class="container-fluid">
                            <div class="row merged">
                                <div class="col-md-10 ms-sm-5 ms-md-5 mb-5 ">
                
                                    <img class="img-picture" id="profile-avatar" name="profile-avatar" src = '/images/user_avatar.png' onerror="this.src = '/images/user_avatar.png'" />
                                    <form class="edit-photo" method="dialog" id="form-upload-avatar" onsubmit="return false">
                                        <i class="fa fa-camera-retro"></i>

                                        <label for="profileAvatar">
                                            Edit Display Photo
                                        </label>
                                        <br>
                                        <input type="file" accept="image/*" name="profileAvatar" name="profileAvatar" onchange="uploadAvatar()" />
                                    </form>

                                    
                                </div>
                                
                            </div>
                        </div>

	  
					</div>
				  </div>
				</div>
			  </div>
			</div>
		  </div>
		</div>
	</section>
    <script>
        var isUpdateProfile = true;




        function showProfileData() {
            
            document.getElementById("profile-avatar").setAttribute("src", mainURL + "/" + window.user.profileAvatar);

            document.getElementById("username").value = window.user.username;
            document.getElementById("name").value =window.user.name;
            document.querySelector(".name").innerHTML = window.user.name;
            document.querySelector(".birth_date").value = window.user.birth_date;
            document.querySelector(".city").value = window.user.city;
            document.querySelector(".country").value = window.user.country;
            document.querySelector(".aboutMe").value = window.user.aboutMe;
        } 
        
        function uploadAvatar(form) {
		var form = document.getElementById("form-upload-avatar");

		var ajax = new XMLHttpRequest();
		ajax.open("POST", "/uploadprofileAvatar", true);

		ajax.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {

				var response = JSON.parse(this.responseText);

				document.getElementById("profile-avatar").setAttribute("src", response.data);
			}
		};

		var formData = new FormData(form);
		formData.append("accessToken", localStorage.getItem("accessToken"));
		ajax.send(formData);

		return false;
	}
    function doUpdateProfile(form) {
		form.submit.setAttribute("disabled", "disabled");
		form.submit.innerHTML = "<span>Loading...</span>";

		var ajax = new XMLHttpRequest();
		ajax.open("POST", "/updateProfile", true);

		ajax.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {

				form.submit.removeAttribute("disabled");
				form.submit.innerHTML = "<span>Save</span>";

				var response = JSON.parse(this.responseText);

				alert(response.message);
			}
		};

		var formData = new FormData(form);
		formData.append("accessToken", localStorage.getItem("accessToken"));
		ajax.send(formData);

		return false;
	}
    </script>
    
    <!--footer-->
    <footer class="footer text-white pt-5 pb-4"  style="background-color: rgb(39, 40, 43);">
        <div class="container  text-md-left">
            <div class="row  text-md-left">
                <div class="col-md-4 col-xl-4 mx-auto mt-3">
                    <h5 class="text-uppercase mb-4 font-weight-bold text-primary">Connect with us on social media</h5>
                    <ul class="list-unstyled list-inline">
                        <li class="list-inline-item ">
                            <a href="#" class="btn-floating btn-sm text-white" style="font-size: 30px;"><i class="fab fa-facebook"></i></a>
                        </li>
                        <li class="list-inline-item ">
                            <a href="#" class="btn-floating btn-sm text-white" style="font-size: 30px;"><i class="fab fa-twitter"></i></a>
                        </li>
                        <li class="list-inline-item ">
                            <a href="#" class="btn-floating btn-sm text-white" style="font-size: 30px;"><i class="fab fa-google-plus"></i></a>
                        </li>
                        <li class="list-inline-item ">
                            <a href="#" class="btn-floating btn-sm text-white" style="font-size: 30px;"><i class="fab fa-linkedin-in"></i></a>
                        </li>
                        <li class="list-inline-item ">
                            <a href="#" class="btn-floating btn-sm text-white" style="font-size: 30px;"><i class="fab fa-instagram"></i></a>
                        </li>
                    </ul>
                </div>
                <div class="col-md-2 col-log-2 col-xl-2 mx-auto mt-3">
                    <h5 class="text-uppercase mb-4 font-weight-bold text-primary">About us</h5>
                    <p>
                        <a href="#" class="text-white text-decoration-none">About our cmmunity</a>
                    </p>
                    <p>
                        <a href="#" class="text-white text-decoration-none">The team</a>
                    </p>
                    <p>
                        <a href="#" class="text-white text-decoration-none">How it works</a>
                    </p>
                    <p>
                        <a href="#" class="text-white text-decoration-none">Privacy Policy</a>
                    </p>
                    <p>
                        <a href="#" class="text-white text-decoration-none">Cookie Policy</a>
                    </p>
                </div>
                <div class="col-md-3 col-lg-3 col-xl-3 mx-auto mt-3">
                    <h5 class="text-uppercase mb-4 font-weight-bold text-primary">More</h5>
                    <p>
                        <a href="#" class="text-white text-decoration-none">Éducation</a>
                    </p>
                    <p>
                        <a href="#" class="text-white text-decoration-none">help</a>
                    </p>
                    <p>
                        <a href="#" class="text-white text-decoration-none">About inpt</a>
                    </p>
                    <p>
                        <a href="#" class="text-white text-decoration-none">Privacy Policy</a>
                    </p>
                    <p>
                        <a href="#" class="text-white text-decoration-none">Cookie Policy</a>
                    </p>
                </div>
                <div class="col-md-3 col-lg-3 col-xl-3 mx-auto mt-3">
                    <h5 class="text-uppercase mb-4 font-weight-bold text-primary">Contact</h5>
                    <p>
                        <i class="fas fa-home me-3"></i>Rabat, Morocco
                    </p>
                    <p>
                        <i class="fas fa-envelope me-3"></i>inptcommunity@gmail.com
                    </p>
                    <p>
                        <i class="fas fa-phone me-3"></i>+212 696956119
                    </p>
                    <hr class="mb-4">
                    <div class="row align-items-center">
                        <div class="col-md-8 col-lg-8">
                            Copyright @2022 <br>
                            All rights reseved by:
                            <a href="#" class="text-decoration-none">Institut National des Postes et Télécomunication</a>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </footer>

    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
</body>
</html>